$(function () {
    /**
     * 显示隐藏键盘
     */
    $(".div-w").on("click",function () {
        $(".keyboard").show();
    })
    $(".xia-icon > img").on("click",function () {
        $(".keyboard").hide();
    })

    /**
     * 小键盘输入数字
     */
    /
    $('.key-number li.num').on("click",function(){
        var reg = /.*\..*/;
        var money = document.getElementById("money");
        money.innerText += this.innerText;
        $("#money_0").hide();
        $("#btn-dis").attr("disabled",false);
        $("#btn-dis").addClass("red-bg");
        var reg_text = money.innerText.replace(/^(\-)*(\d+)\.(\d\d).*$/,'$1$2.$3');
        if(isNaN(reg_text)){
            mui.toast('输入格式不正确！');
            $("#money").empty();
            $("#sum").text("0.00");
            $("#money_0").show();
            $("#btn-dis").attr("disabled",true);
            $("#btn-dis").removeClass("red-bg").addClass("red-dis-bg");
            return;
        }
        if(reg_text > 200){
            mui.toast('红包不能大于200！');
            $("#money").empty();
            $("#sum").text("0.00");
            $("#money_0").show();
            $("#btn-dis").attr("disabled",true);
            $("#btn-dis").removeClass("red-bg").addClass("red-dis-bg");
            return;
        }
        toDecimal2(reg_text)
        $("#money").text(reg_text)
    });
    $('.key-number li.li-del').click(function(e){
        var money = document.getElementById("money");
        var oDivHtml = money.innerText;
        money.innerText = oDivHtml.substring(0,oDivHtml.length-1);
        var div_text = money.innerText;
        toDecimal2(div_text);
        if(div_text== ""){
            $("#money").empty();
            $("#sum").text("0.00");
            $("#money_0").show();
            $("#btn-dis").attr("disabled",true);
            $("#btn-dis").removeClass("red-bg").addClass("red-dis-bg");
        }
    })
})


/**
 * 保留两位小数点
 * @param x
 * @returns {*}
 */
function toDecimal2(x) {
    var f = parseFloat(x);
    if (isNaN(f)) {
        return false;
    }
    var f = x
    var s = f.toString();
    var rs = s.indexOf('.');
    if (rs < 0) {
        rs = s.length;
        s += '.';
    }
    while (s.length <= rs + 2) {
        s += '0';
    }
    $("#sum").text(s)
    return s;
}